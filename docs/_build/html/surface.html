

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Surface Operators &mdash; GalSim 2.2.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Helper Functions and Classes" href="utilities.html" />
    <link rel="prev" title="Sensor Models" href="sensor.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> GalSim
          

          
          </a>

          
            
            
              <div class="version">
                2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">Images and Related Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="sb.html">Surface Brightness Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="chromatic.html">Wavelength-dependent Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="wcs.html">World Coordinate Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="random.html">Noise and Random Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="wl.html">Weak Lensing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="photon.html">Photon Shooting</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="photon_array.html">Photon Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensor.html">Sensor Models</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Surface Operators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Helper Functions and Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">Errors and Warnings</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">The Config Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="hsm.html">The HSM Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="des.html">The DES Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="wfirst.html">The WFIRST Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="shared.html">Shared Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Revision History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GalSim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="photon.html">Photon Shooting</a> &raquo;</li>
        
      <li>Surface Operators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/surface.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="surface-operators">
<h1>Surface Operators<a class="headerlink" href="#surface-operators" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="galsim.WavelengthSampler">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">WavelengthSampler</code><span class="sig-paren">(</span><em class="sig-param">sed</em>, <em class="sig-param">bandpass</em>, <em class="sig-param">rng=None</em>, <em class="sig-param">npoints=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/photon_array.html#WavelengthSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.WavelengthSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is a sensor operation that uses sed.sampleWavelength to set the wavelengths
array of a <a class="reference internal" href="photon_array.html#galsim.PhotonArray" title="galsim.PhotonArray"><code class="xref any py py-class docutils literal notranslate"><span class="pre">PhotonArray</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sed</strong> – The <a class="reference internal" href="sed.html#galsim.SED" title="galsim.SED"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SED</span></code></a> to use for the objects spectral energy distribution.</p></li>
<li><p><strong>bandpass</strong> – A <a class="reference internal" href="bandpass.html#galsim.Bandpass" title="galsim.Bandpass"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Bandpass</span></code></a> object representing a filter, or None to sample over the full
<a class="reference internal" href="sed.html#galsim.SED" title="galsim.SED"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SED</span></code></a> wavelength range.</p></li>
<li><p><strong>rng</strong> – If provided, a random number generator that is any kind of <a class="reference internal" href="deviate.html#galsim.BaseDeviate" title="galsim.BaseDeviate"><code class="xref any py py-class docutils literal notranslate"><span class="pre">BaseDeviate</span></code></a>
object. If <code class="docutils literal notranslate"><span class="pre">rng</span></code> is None, one will be automatically created, using the
time as a seed. [default: None]</p></li>
<li><p><strong>npoints</strong> – Number of points <a class="reference internal" href="deviate.html#galsim.DistDeviate" title="galsim.DistDeviate"><code class="xref any py py-class docutils literal notranslate"><span class="pre">DistDeviate</span></code></a> should use for its internal interpolation
tables. [default: None, which uses the <a class="reference internal" href="deviate.html#galsim.DistDeviate" title="galsim.DistDeviate"><code class="xref any py py-class docutils literal notranslate"><span class="pre">DistDeviate</span></code></a> default]</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="galsim.WavelengthSampler.applyTo">
<code class="sig-name descname">applyTo</code><span class="sig-paren">(</span><em class="sig-param">photon_array</em>, <em class="sig-param">local_wcs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/photon_array.html#WavelengthSampler.applyTo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.WavelengthSampler.applyTo" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign wavelengths to the photons sampled from the SED * Bandpass.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="galsim.FRatioAngles">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">FRatioAngles</code><span class="sig-paren">(</span><em class="sig-param">fratio</em>, <em class="sig-param">obscuration=0.0</em>, <em class="sig-param">rng=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/photon_array.html#FRatioAngles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.FRatioAngles" title="Permalink to this definition">¶</a></dt>
<dd><p>A surface-layer operator that assigns photon directions based on the f/ratio and
obscuration.</p>
<p>Assigns arrival directions at the focal plane for photons, drawing from a uniform
brightness distribution between the obscuration angle and the edge of the pupil defined
by the f/ratio of the telescope.  The angles are expressed in terms of slopes dx/dz
and dy/dz.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fratio</strong> – The f/ratio of the telescope (e.g. 1.2 for LSST)</p></li>
<li><p><strong>obscuration</strong> – Linear dimension of central obscuration as fraction of aperture
linear dimension. [0., 1.).  [default: 0.0]</p></li>
<li><p><strong>rng</strong> – A random number generator to use or None, in which case an rng
will be automatically constructed for you. [default: None]</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="galsim.FRatioAngles.applyTo">
<code class="sig-name descname">applyTo</code><span class="sig-paren">(</span><em class="sig-param">photon_array</em>, <em class="sig-param">local_wcs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/photon_array.html#FRatioAngles.applyTo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.FRatioAngles.applyTo" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign directions to the photons in photon_array.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="galsim.PhotonDCR">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">PhotonDCR</code><span class="sig-paren">(</span><em class="sig-param">base_wavelength</em>, <em class="sig-param">scale_unit=coord.arcsec</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/photon_array.html#PhotonDCR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.PhotonDCR" title="Permalink to this definition">¶</a></dt>
<dd><p>A surface-layer operator that applies the effect of differential chromatic refraction (DCR)
and optionally the chromatic dilation due to atmospheric seeing.</p>
<p>Due to DCR, blue photons land closer to the zenith than red photons.  Kolmogorov turbulence
also predicts that blue photons get spread out more by the atmosphere than red photons,
specifically FWHM is proportional to <span class="math notranslate nohighlight">\(\lambda^{-0.2}\)</span>.  Both of these effects can be
implemented by wavelength-dependent shifts of the photons.</p>
<p>Since DCR depends on the zenith angle and the parallactic angle (which is the position angle of
the zenith measured from North through East) of the object being drawn, these must be specified
via keywords.  There are four ways to specify these values:</p>
<ol class="arabic simple">
<li><p>explicitly provide <code class="docutils literal notranslate"><span class="pre">zenith_angle</span></code> as a keyword of type <a class="reference internal" href="units.html#galsim.Angle" title="galsim.Angle"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Angle</span></code></a>, and <code class="docutils literal notranslate"><span class="pre">parallactic_angle</span></code>
will be assumed to be 0 by default.</p></li>
<li><p>explicitly provide both <code class="docutils literal notranslate"><span class="pre">zenith_angle</span></code> and <code class="docutils literal notranslate"><span class="pre">parallactic_angle</span></code> as keywords of type
<a class="reference internal" href="units.html#galsim.Angle" title="galsim.Angle"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Angle</span></code></a>.</p></li>
<li><p>provide the coordinates of the object <code class="docutils literal notranslate"><span class="pre">obj_coord</span></code> and the coordinates of the zenith
<code class="docutils literal notranslate"><span class="pre">zenith_coord</span></code> as keywords of type <a class="reference internal" href="wcs.html#galsim.CelestialCoord" title="galsim.CelestialCoord"><code class="xref any py py-class docutils literal notranslate"><span class="pre">CelestialCoord</span></code></a>.</p></li>
<li><p>provide the coordinates of the object <code class="docutils literal notranslate"><span class="pre">obj_coord</span></code> as a <a class="reference internal" href="wcs.html#galsim.CelestialCoord" title="galsim.CelestialCoord"><code class="xref any py py-class docutils literal notranslate"><span class="pre">CelestialCoord</span></code></a>, the hour angle
of the object <code class="docutils literal notranslate"><span class="pre">HA</span></code> as an <a class="reference internal" href="units.html#galsim.Angle" title="galsim.Angle"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Angle</span></code></a>, and the latitude of the observer <code class="docutils literal notranslate"><span class="pre">latitude</span></code> as an
<a class="reference internal" href="units.html#galsim.Angle" title="galsim.Angle"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Angle</span></code></a>.</p></li>
</ol>
<p>DCR also depends on temperature, pressure and water vapor pressure of the atmosphere.  The
default values for these are expected to be appropriate for LSST at Cerro Pachon, Chile, but
they are broadly reasonable for most observatories.</p>
<p>This surface op is intended to match the functionality of <a class="reference internal" href="chromaticobject.html#galsim.ChromaticAtmosphere" title="galsim.ChromaticAtmosphere"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ChromaticAtmosphere</span></code></a>, but acting
on the photon array rather than as a <a class="reference internal" href="chromaticobject.html#galsim.ChromaticObject" title="galsim.ChromaticObject"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ChromaticObject</span></code></a>.  The photons will need to have
wavelengths defined in order to work.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The alpha parameter is only appropriate for stars.  This surface op will act on
all of the photons, so applying a chromatic dilation according to the chromatic
seeing is the wrong thing to do when the surface brightness being rendered is
not a pure PSF.  As such, the default is alpha=0, not -0.2, which would be
appropriate for Kolmogorov turbulence.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_wavelength</strong> – Wavelength (in nm) represented by the fiducial photon positions</p></li>
<li><p><strong>scale_unit</strong> – Units used for the positions of the photons.  [default: galsim.arcsec]</p></li>
<li><p><strong>alpha</strong> – Power law index for wavelength-dependent seeing.  This should only
be used if doing a star-only simulation.  It is not correct when
drawing galaxies. [default: 0.]</p></li>
<li><p><strong>zenith_angle</strong> – <a class="reference internal" href="units.html#galsim.Angle" title="galsim.Angle"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Angle</span></code></a> from object to zenith, expressed as an <a class="reference internal" href="units.html#galsim.Angle" title="galsim.Angle"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Angle</span></code></a>. [default: 0]</p></li>
<li><p><strong>parallactic_angle</strong> – Parallactic angle, i.e. the position angle of the zenith, measured
from North through East.  [default: 0]</p></li>
<li><p><strong>obj_coord</strong> – Celestial coordinates of the object being drawn as a <a class="reference internal" href="wcs.html#galsim.CelestialCoord" title="galsim.CelestialCoord"><code class="xref any py py-class docutils literal notranslate"><span class="pre">CelestialCoord</span></code></a>.
[default: None]</p></li>
<li><p><strong>zenith_coord</strong> – Celestial coordinates of the zenith as a <a class="reference internal" href="wcs.html#galsim.CelestialCoord" title="galsim.CelestialCoord"><code class="xref any py py-class docutils literal notranslate"><span class="pre">CelestialCoord</span></code></a>.
[default: None]</p></li>
<li><p><strong>HA</strong> – Hour angle of the object as an <a class="reference internal" href="units.html#galsim.Angle" title="galsim.Angle"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Angle</span></code></a>. [default: None]</p></li>
<li><p><strong>latitude</strong> – Latitude of the observer as an <a class="reference internal" href="units.html#galsim.Angle" title="galsim.Angle"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Angle</span></code></a>. [default: None]</p></li>
<li><p><strong>pressure</strong> – Air pressure in kiloPascals.  [default: 69.328 kPa]</p></li>
<li><p><strong>temperature</strong> – Temperature in Kelvins.  [default: 293.15 K]</p></li>
<li><p><strong>H2O_pressure</strong> – Water vapor pressure in kiloPascals.  [default: 1.067 kPa]</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="galsim.PhotonDCR.applyTo">
<code class="sig-name descname">applyTo</code><span class="sig-paren">(</span><em class="sig-param">photon_array</em>, <em class="sig-param">local_wcs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/photon_array.html#PhotonDCR.applyTo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.PhotonDCR.applyTo" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the DCR effect to the photons</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="utilities.html" class="btn btn-neutral float-right" title="Helper Functions and Classes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sensor.html" class="btn btn-neutral float-left" title="Sensor Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, GalSim-developers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>