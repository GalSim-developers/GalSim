<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zernike Functions &mdash; GalSim 2.3.4 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Differential Chromatic Refraction" href="dcr.html" />
    <link rel="prev" title="Fourier Transforms" href="fft.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> GalSim
          </a>
              <div class="version">
                2.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">Images and Related Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="sb.html">Surface Brightness Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="chromatic.html">Wavelength-dependent Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="wcs.html">World Coordinate Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="random.html">Noise and Random Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="wl.html">Weak Lensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="photon.html">Photon Shooting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="utilities.html">Helper Functions and Classes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="table.html">Lookup Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="catalog.html">Catalogs and Input Dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpolant.html">Interpolants</a></li>
<li class="toctree-l2"><a class="reference internal" href="fits.html">Interfacing with FITS Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="integ.html">Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="bessel.html">Bessel Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="fft.html">Fourier Transforms</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Zernike Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="dcr.html">Differential Chromatic Refraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="cd.html">Charge Deflection Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">Miscellaneous Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">Errors and Warnings</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">The Config Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="hsm.html">The HSM Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="des.html">The DES Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="roman.html">The Roman Space Telescope Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="shared.html">Shared Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Revision History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GalSim</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="utilities.html">Helper Functions and Classes</a> &raquo;</li>
      <li>Zernike Functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/zernike.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="zernike-functions">
<h1>Zernike Functions<a class="headerlink" href="#zernike-functions" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="galsim.zernike.Zernike">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">galsim.zernike.</span></code><code class="sig-name descname"><span class="pre">Zernike</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_outer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_inner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#Zernike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.Zernike" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to represent a Zernike polynomial series
(<a class="reference external" href="http://en.wikipedia.org/wiki/Zernike_polynomials#Zernike_polynomials">http://en.wikipedia.org/wiki/Zernike_polynomials#Zernike_polynomials</a>).</p>
<p>Zernike polynomials form an orthonormal basis over the unit circle.  The convention used here is
for the normality constant to equal the area of integration, which is pi for the unit circle.
I.e.,</p>
<div class="math notranslate nohighlight">
\[\int_\mathrm{unit circle} Z_i Z_j dA = \pi \delta_{i, j}.\]</div>
<p>Two generalizations of the unit circle Zernike polynomials are also available in this class:
annular Zernike polynomials, and polynomials defined over non-unit-radius circles.</p>
<p>Annular Zernikes are orthonormal over an annulus instead of a circle (see Mahajan, J. Opt. Soc.
Am. 71, 1, (1981)).  Similarly, the non-unit-radius polynomials are orthonormal over a region
with outer radius not equal to 1.  Taken together, these generalizations yield the
orthonormality condition:</p>
<div class="math notranslate nohighlight">
\[\int_\mathrm{annulus} Z_i Z_j dA =
\pi \left(R_\mathrm{outer}^2 - R_\mathrm{inner}^2\right) \delta_{i, j}\]</div>
<p>where <span class="math notranslate nohighlight">\(0 &lt;= R_\mathrm{inner} &lt; R_\mathrm{outer}\)</span> indicate the inner and outer radii of
the annulus over which the polynomials are orthonormal.</p>
<p>The indexing convention for i and j above is that from Noll, J. Opt. Soc. Am. 66, 207-211(1976).
Note that the Noll indices begin at 1; there is no Z_0.  Because of this, the series
coefficients argument <code class="docutils literal notranslate"><span class="pre">coef</span></code> effectively begins with <code class="docutils literal notranslate"><span class="pre">coef[1]</span></code> (<code class="docutils literal notranslate"><span class="pre">coef[0]</span></code> is ignored).
This convention is used consistently throughout GalSim, e.g., <a class="reference internal" href="psf.html#galsim.OpticalPSF" title="galsim.OpticalPSF"><code class="xref any py py-class docutils literal notranslate"><span class="pre">OpticalPSF</span></code></a>, <a class="reference internal" href="phase_psf.html#galsim.OpticalScreen" title="galsim.OpticalScreen"><code class="xref any py py-class docutils literal notranslate"><span class="pre">OpticalScreen</span></code></a>,
<a class="reference internal" href="#galsim.zernike.zernikeRotMatrix" title="galsim.zernike.zernikeRotMatrix"><code class="xref any py py-func docutils literal notranslate"><span class="pre">zernikeRotMatrix</span></code></a>, and <a class="reference internal" href="#galsim.zernike.zernikeBasis" title="galsim.zernike.zernikeBasis"><code class="xref any py py-func docutils literal notranslate"><span class="pre">zernikeBasis</span></code></a>.</p>
<p>As an example, the first few Zernike polynomials in terms of Cartesian coordinates x and y are</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 27%" />
<col style="width: 73%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Noll index</p></th>
<th class="head"><p>Polynomial</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>2 x</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>2 y</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>sqrt(3) (2 (x^2 + y^2) - 1)</p></td>
</tr>
</tbody>
</table>
<p>A few mathematical convenience operations are additionally available.  Zernikes can be added,
subtracted, or multiplied together, or multiplied by scalars.  Note, however, that two
Zernikes can only be combined this way if they have matching <code class="docutils literal notranslate"><span class="pre">R_outer</span></code> and <code class="docutils literal notranslate"><span class="pre">R_inner</span></code>
attributes.  Zernike gradients, Laplacians and the determinant of the Hessian matrix are also
available as properties that return new <a class="reference internal" href="#galsim.zernike.Zernike" title="galsim.zernike.Zernike"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Zernike</span></code></a> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coef</strong> – Zernike series coefficients.  Note that coef[i] corresponds to Z_i under the
Noll index convention, and coef[0] is ignored.  (I.e., coef[1] is ‘piston’,
coef[4] is ‘defocus’, …)</p></li>
<li><p><strong>R_outer</strong> – Outer radius.  [default: 1.0]</p></li>
<li><p><strong>R_inner</strong> – Inner radius.  [default: 0.0]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="galsim.zernike.Zernike.__add__">
<code class="sig-name descname"><span class="pre">__add__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rhs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#Zernike.__add__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.Zernike.__add__" title="Permalink to this definition">¶</a></dt>
<dd><p>Add two Zernikes.</p>
<p>Requires that each operand’s <code class="docutils literal notranslate"><span class="pre">R_outer</span></code> and <code class="docutils literal notranslate"><span class="pre">R_inner</span></code> attributes are the same.</p>
</dd></dl>

<dl class="py method">
<dt id="galsim.zernike.Zernike.__sub__">
<code class="sig-name descname"><span class="pre">__sub__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rhs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#Zernike.__sub__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.Zernike.__sub__" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract two Zernikes.</p>
<p>Requires that each operand’s <code class="docutils literal notranslate"><span class="pre">R_outer</span></code> and <code class="docutils literal notranslate"><span class="pre">R_inner</span></code> attributes are the same.</p>
</dd></dl>

<dl class="py method">
<dt id="galsim.zernike.Zernike.__neg__">
<code class="sig-name descname"><span class="pre">__neg__</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#Zernike.__neg__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.Zernike.__neg__" title="Permalink to this definition">¶</a></dt>
<dd><p>Negate a Zernike.</p>
</dd></dl>

<dl class="py method">
<dt id="galsim.zernike.Zernike.__mul__">
<code class="sig-name descname"><span class="pre">__mul__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rhs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#Zernike.__mul__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.Zernike.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply two Zernikes, or multiply a Zernike by a scalar.</p>
<p>If both operands are Zernikes, then the <code class="docutils literal notranslate"><span class="pre">R_outer</span></code> and <code class="docutils literal notranslate"><span class="pre">R_inner</span></code> attributes of each must
be the same.</p>
</dd></dl>

<dl class="py method">
<dt id="galsim.zernike.Zernike.__rmul__">
<code class="sig-name descname"><span class="pre">__rmul__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rhs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#Zernike.__rmul__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.Zernike.__rmul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Equivalent to obj * rhs.  See <a class="reference internal" href="#galsim.zernike.Zernike.__mul__" title="galsim.zernike.Zernike.__mul__"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">__mul__</span></code></a> for details.</p>
</dd></dl>

<dl class="py method">
<dt id="galsim.zernike.Zernike.__call__">
<code class="sig-name descname"><span class="pre">__call__</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#Zernike.__call__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.Zernike.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate this Zernike polynomial series at Cartesian coordinates x and y.
Synonym for <a class="reference internal" href="#galsim.zernike.Zernike.evalCartesian" title="galsim.zernike.Zernike.evalCartesian"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">evalCartesian</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – x-coordinate of evaluation points.  Can be list-like.</p></li>
<li><p><strong>y</strong> – y-coordinate of evaluation points.  Can be list-like.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series evaluations as numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="galsim.zernike.Zernike.evalCartesian">
<code class="sig-name descname"><span class="pre">evalCartesian</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#Zernike.evalCartesian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.Zernike.evalCartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate this Zernike polynomial series at Cartesian coordinates x and y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – x-coordinate of evaluation points.  Can be list-like.</p></li>
<li><p><strong>y</strong> – y-coordinate of evaluation points.  Can be list-like.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series evaluations as numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="galsim.zernike.Zernike.evalCartesianGrad">
<code class="sig-name descname"><span class="pre">evalCartesianGrad</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#Zernike.evalCartesianGrad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.Zernike.evalCartesianGrad" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the gradient of this Zernike polynomial series at cartesian coordinates
x and y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – x-coordinate of evaluation points.  Can be list-like.</p></li>
<li><p><strong>y</strong> – y-coordinate of evaluation points.  Can be list-like.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of arrays for x-gradient and y-gradient.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="galsim.zernike.Zernike.evalPolar">
<code class="sig-name descname"><span class="pre">evalPolar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#Zernike.evalPolar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.Zernike.evalPolar" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate this Zernike polynomial series at polar coordinates rho and theta.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho</strong> – radial coordinate of evaluation points.  Can be list-like.</p></li>
<li><p><strong>theta</strong> – azimuthal coordinate in radians (or as <a class="reference internal" href="units.html#galsim.Angle" title="galsim.Angle"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Angle</span></code></a> object) of evaluation points.
Can be list-like.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series evaluations as numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="galsim.zernike.Zernike.rotate">
<code class="sig-name descname"><span class="pre">rotate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#Zernike.rotate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.Zernike.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new Zernike polynomial series rotated by angle theta.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">Zernike</span><span class="p">(</span><span class="n">coefs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Zrot</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span><span class="o">.</span><span class="n">evalPolar</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">th</span><span class="p">)</span> <span class="o">==</span> <span class="n">Zrot</span><span class="o">.</span><span class="n">evalPolar</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">th</span> <span class="o">+</span> <span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>theta</strong> – angle in radians.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A new Zernike object.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="galsim.zernike.noll_to_zern">
<code class="sig-prename descclassname"><span class="pre">galsim.zernike.</span></code><code class="sig-name descname"><span class="pre">noll_to_zern</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#noll_to_zern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.noll_to_zern" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert linear Noll index to tuple of Zernike indices.
j is the linear Noll coordinate, n is the radial Zernike index and m is the azimuthal Zernike
index.</p>
<p>c.f. <a class="reference external" href="https://oeis.org/A176988">https://oeis.org/A176988</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>j</strong> – Zernike mode Noll index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(n, m) tuple of Zernike indices</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galsim.zernike.zernikeRotMatrix">
<code class="sig-prename descclassname"><span class="pre">galsim.zernike.</span></code><code class="sig-name descname"><span class="pre">zernikeRotMatrix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#zernikeRotMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.zernikeRotMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct Zernike basis rotation matrix.  This matrix can be used to convert a set of Zernike
polynomial series coefficients expressed in one coordinate system to an equivalent set of
coefficients expressed in a rotated coordinate system.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">Zernike</span><span class="p">(</span><span class="n">coefs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">zernikeRotMatrix</span><span class="p">(</span><span class="n">jmax</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotCoefs</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">coefs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Zrot</span> <span class="o">=</span> <span class="n">Zernike</span><span class="p">(</span><span class="n">rotCoefs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span><span class="o">.</span><span class="n">evalPolar</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">th</span><span class="p">)</span> <span class="o">==</span> <span class="n">Zrot</span><span class="o">.</span><span class="n">evalPolar</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">th</span> <span class="o">+</span> <span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that not all values of <code class="docutils literal notranslate"><span class="pre">jmax</span></code> are allowed.  For example, jmax=2 raises an Exception,
since a non-zero Z_2 coefficient will in general rotate into a combination of Z_2 and Z_3
coefficients, and therefore the needed rotation matrix requires jmax=3.  If you run into this
kind of Exception, raising jmax by 1 will eliminate it.</p>
<p>Also note that the returned matrix is intended to multiply a vector of Zernike coefficients
<code class="docutils literal notranslate"><span class="pre">coef</span></code> indexed following the Noll (1976) convention, which starts at 1.  Since python
sequences start at 0, we adopt the convention that <code class="docutils literal notranslate"><span class="pre">coef[0]</span></code> is unused, and <code class="docutils literal notranslate"><span class="pre">coef[i]</span></code>
corresponds to the coefficient multiplying Z_i.  As a result, the size of the returned matrix
is [jmax+1, jmax+1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jmax</strong> – Maximum Zernike index (in the Noll convention) over which to construct matrix.</p></li>
<li><p><strong>theta</strong> – angle of rotation in radians.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Matrix of size [jmax+1, jmax+1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galsim.zernike.zernikeBasis">
<code class="sig-prename descclassname"><span class="pre">galsim.zernike.</span></code><code class="sig-name descname"><span class="pre">zernikeBasis</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_outer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_inner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#zernikeBasis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.zernikeBasis" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct basis of Zernike polynomial series up to Noll index <code class="docutils literal notranslate"><span class="pre">jmax</span></code>, evaluated at a
specific set of points <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>Useful for fitting Zernike polynomials to data, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">myDataToFit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span> <span class="o">=</span> <span class="n">zernikeBasis</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coefs</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resids</span> <span class="o">=</span> <span class="n">Zernike</span><span class="p">(</span><span class="n">coefs</span><span class="p">)</span><span class="o">.</span><span class="n">evalCartesian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span>
</pre></div>
</div>
<p>or equivalently:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resids</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">coefs</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">z</span>
</pre></div>
</div>
<p>Note that since we follow the Noll indexing scheme for Zernike polynomials, which begins at 1,
but python sequences are indexed from 0, the length of the leading dimension in the result is
<code class="docutils literal notranslate"><span class="pre">jmax+1</span></code> instead of <code class="docutils literal notranslate"><span class="pre">jmax</span></code>.  We somewhat arbitrarily fill the 0th slice along the first
dimension with 0s (result[0, …] == 0) so that it doesn’t impact the results of
<code class="docutils literal notranslate"><span class="pre">np.linalg.lstsq</span></code> as in the example above.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jmax</strong> – Maximum Noll index to use.</p></li>
<li><p><strong>x</strong> – x-coordinates (can be list-like, congruent to y)</p></li>
<li><p><strong>y</strong> – y-coordinates (can be list-like, congruent to x)</p></li>
<li><p><strong>R_outer</strong> – Outer radius.  [default: 1.0]</p></li>
<li><p><strong>R_inner</strong> – Inner radius.  [default: 0.0]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[jmax+1, x.shape] array.  Slicing over first index gives basis vectors corresponding
to individual Zernike polynomials.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="galsim.zernike.describe_zernike">
<code class="sig-prename descclassname"><span class="pre">galsim.zernike.</span></code><code class="sig-name descname"><span class="pre">describe_zernike</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/zernike.html#describe_zernike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#galsim.zernike.describe_zernike" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a human-readable string describing the jth (unit circle) Zernike mode as a bivariate
polynomial in x and y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>j</strong> – Zernike mode Noll index</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>string description of jth mode.</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fft.html" class="btn btn-neutral float-left" title="Fourier Transforms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dcr.html" class="btn btn-neutral float-right" title="Differential Chromatic Refraction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, GalSim-developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>