

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Miscellaneous Utilities &mdash; GalSim 2.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Errors and Warnings" href="errors.html" />
    <link rel="prev" title="Charge Deflection Model" href="cd.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> GalSim
          

          
          </a>

          
            
            
              <div class="version">
                2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">Images and Related Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="sb.html">Surface Brightness Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="wcs.html">World Coordinate Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="random.html">Noise and Random Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="chromatic.html">Wavelength-dependent Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="wl.html">Weak Lensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="photon.html">Photon Shooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="coord.html">Angles and Coordinates</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="utilities.html">Helper Functions and Classes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="table.html">Lookup Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="catalog.html">Catalogs and Input Dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpolant.html">Interpolants</a></li>
<li class="toctree-l2"><a class="reference internal" href="fits.html">Interfacing with FITS Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="integ.html">Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="bessel.html">Bessel Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="fft.html">Fourier Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="zernike.html">Zernike Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="dcr.html">Differential Chromatic Refraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="cd.html">Charge Deflection Model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Miscellaneous Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#decorators">Decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lru-cache">LRU Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-possibly-useful-classes">Other Possibly Useful Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#math-calculations">Math Calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utilities-related-to-numpy-functions">Utilities Related to NumPy Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-helper-functions">Other Helper Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#galsim-specific-helper-functions">GalSim-specific Helper Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">Errors and Warnings</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">The Config Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="hsm.html">The HSM Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="des.html">The DES Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="wfirst.html">The WFIRST Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="shared.html">Shared Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Revision History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GalSim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="utilities.html">Helper Functions and Classes</a> &raquo;</li>
        
      <li>Miscellaneous Utilities</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/misc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="miscellaneous-utilities">
<h1>Miscellaneous Utilities<a class="headerlink" href="#miscellaneous-utilities" title="Permalink to this headline">¶</a></h1>
<p>We have a whole bunch of miscellaneous helper functions and classes in the <code class="docutils literal notranslate"><span class="pre">galsim.utilities</span></code>
module.  Most of these are probably not particularly useful for anything other than internal
GalSim code.  But we highlight a few things that might be more widely useful beyond GalSim usage.</p>
<div class="section" id="decorators">
<h2>Decorators<a class="headerlink" href="#decorators" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="galsim.utilities.lazy_property">
<em class="property">class </em><code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">lazy_property</code><span class="sig-paren">(</span><em class="sig-param">fget</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#lazy_property"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.lazy_property" title="Permalink to this definition">¶</a></dt>
<dd><p>This decorator will act similarly to &#64;property, but will be efficient for multiple access
to values that require some significant calculation.</p>
<p>It works by replacing the attribute with the computed value, so after the first access,
the property (an attribute of the class) is superseded by the new attribute of the instance.</p>
<p>Note that is should only be used for non-mutable data, since the calculation will not be
repeated if anything about the instance changes.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@lazy_property</span>
<span class="k">def</span> <span class="nf">slow_function_to_be_used_as_a_property</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span>  <span class="o">...</span>  <span class="c1"># Some slow calculation.</span>
    <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
<p>Base on an answer from <a class="reference external" href="http://stackoverflow.com/a/6849299">http://stackoverflow.com/a/6849299</a></p>
</dd></dl>

<dl class="class">
<dt id="galsim.utilities.doc_inherit">
<em class="property">class </em><code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">doc_inherit</code><span class="sig-paren">(</span><em class="sig-param">mthd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#doc_inherit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.doc_inherit" title="Permalink to this definition">¶</a></dt>
<dd><p>This decorator will grab a doc string from a base class version of a method.
Useful if the subclass doesn’t change anything about the method API, but just has
a specialized implementation.  This lets the documentation live only in one place.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Base</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A nice description of the functionality</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Sub</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>

    <span class="nd">@doc_inherit</span>
    <span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Don&#39;t bother with any doc string here.</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>Based on the Docstring Inheritance Decorator at:</p>
<p><a class="reference external" href="https://github.com/ActiveState/code/wiki/Python_index_1">https://github.com/ActiveState/code/wiki/Python_index_1</a></p>
<p>Although I (MJ) modified it slightly, since the original recipe there had a bug that made it
not work properly with 2 levels of sub-classing (e.g. Pixel &lt;- Box &lt;- GSObject).</p>
</dd></dl>

</div>
<div class="section" id="lru-cache">
<h2>LRU Cache<a class="headerlink" href="#lru-cache" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="galsim.utilities.LRU_Cache">
<em class="property">class </em><code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">LRU_Cache</code><span class="sig-paren">(</span><em class="sig-param">user_function</em>, <em class="sig-param">maxsize=1024</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#LRU_Cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.LRU_Cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplified Least Recently Used Cache.</p>
<p>Mostly stolen from <a class="reference external" href="http://code.activestate.com/recipes/577970-simplified-lru-cache/">http://code.activestate.com/recipes/577970-simplified-lru-cache/</a>,
but added a method for dynamic resizing.  The least recently used cached item is
overwritten on a cache miss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user_function</strong> – A python function to cache.</p></li>
<li><p><strong>maxsize</strong> – Maximum number of inputs to cache.  [Default: 1024]</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">slow_function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="c1"># A slow-to-evaluate python function</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="o">...</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span> <span class="o">=</span> <span class="n">slow_function</span><span class="p">(</span><span class="o">*</span><span class="n">k1</span><span class="p">)</span>  <span class="c1"># Calling function is slow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span> <span class="o">=</span> <span class="n">slow_function</span><span class="p">(</span><span class="o">*</span><span class="n">k1</span><span class="p">)</span>  <span class="c1"># Calling again with same args is still slow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cache</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">utilities</span><span class="o">.</span><span class="n">LRU_Cache</span><span class="p">(</span><span class="n">slow_function</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span> <span class="o">=</span> <span class="n">cache</span><span class="p">(</span><span class="o">*</span><span class="n">k1</span><span class="p">)</span>  <span class="c1"># Returns slow_function(*k1), slowly the first time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span> <span class="o">=</span> <span class="n">cache</span><span class="p">(</span><span class="o">*</span><span class="n">k1</span><span class="p">)</span>  <span class="c1"># Returns slow_function(*k1) again, but fast this time.</span>
</pre></div>
</div>
<dl class="method">
<dt id="galsim.utilities.LRU_Cache.resize">
<code class="sig-name descname">resize</code><span class="sig-paren">(</span><em class="sig-param">maxsize</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#LRU_Cache.resize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.LRU_Cache.resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize the cache.</p>
<p>Increasing the size of the cache is non-destructive, i.e., previously cached inputs remain
in the cache.  Decreasing the size of the cache will necessarily remove items from the
cache if the cache is already filled.  Items are removed in least recently used order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>maxsize</strong> – The new maximum number of inputs to cache.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="other-possibly-useful-classes">
<h2>Other Possibly Useful Classes<a class="headerlink" href="#other-possibly-useful-classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="galsim.utilities.WeakMethod">
<em class="property">class </em><code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">WeakMethod</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#WeakMethod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.WeakMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap a method in a weakref.</p>
<p>This is useful if you want to specialize a function if certain conditions hold.
You can check those conditions and return one of several possible implementations as
a <a class="reference internal" href="#galsim.utilities.lazy_property" title="galsim.utilities.lazy_property"><code class="xref any py py-class docutils literal notranslate"><span class="pre">lazy_property</span></code></a>.</p>
<p>Using just a normal <code class="docutils literal notranslate"><span class="pre">weakref</span></code> doesn’t work, but this class will work.</p>
<p>From <a class="reference external" href="http://code.activestate.com/recipes/81253-weakmethod/">http://code.activestate.com/recipes/81253-weakmethod/</a></p>
</dd></dl>

<dl class="class">
<dt id="galsim.utilities.OrderedWeakRef">
<em class="property">class </em><code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">OrderedWeakRef</code><a class="reference internal" href="_modules/galsim/utilities.html#OrderedWeakRef"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.OrderedWeakRef" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign an arbitrary ordering to weakref.ref so that it can be part of a heap.</p>
</dd></dl>

<dl class="class">
<dt id="galsim.utilities.SimpleGenerator">
<em class="property">class </em><code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">SimpleGenerator</code><span class="sig-paren">(</span><em class="sig-param">obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#SimpleGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.SimpleGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple class that is constructed with an arbitrary object.
Then generator() will return that object.</p>
<p>This is useful as a way to use an already existing object in a multiprocessing Proxy,
since that normally needs a factory function.  So this is a factory function that
just returns an already existing object.</p>
</dd></dl>

<dl class="class">
<dt id="galsim.utilities.AttributeDict">
<em class="property">class </em><code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">AttributeDict</code><a class="reference internal" href="_modules/galsim/utilities.html#AttributeDict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.AttributeDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary class that allows for easy initialization and refs to key values via attributes.</p>
<p>NOTE: Modified a little from Jim’s bot.git AttributeDict class so that tab completion now works
in ipython since attributes are actually added to __dict__.</p>
<p>HOWEVER this means the __dict__ attribute has been redefined to be a collections.defaultdict()
so that Jim’s previous default attribute behaviour is also replicated.</p>
<dl class="method">
<dt id="galsim.utilities.AttributeDict.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#AttributeDict.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.AttributeDict.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.utilities.AttributeDict.__repr__">
<code class="sig-name descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#AttributeDict.__repr__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.AttributeDict.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="method">
<dt id="galsim.utilities.AttributeDict.__setattr__">
<code class="sig-name descname">__setattr__</code><span class="sig-paren">(</span><em class="sig-param">name</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#AttributeDict.__setattr__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.AttributeDict.__setattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement setattr(self, name, value).</p>
</dd></dl>

<dl class="method">
<dt id="galsim.utilities.AttributeDict.__str__">
<code class="sig-name descname">__str__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#galsim.utilities.AttributeDict.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return repr(self).</p>
</dd></dl>

<dl class="attribute">
<dt id="galsim.utilities.AttributeDict.__weakref__">
<code class="sig-name descname">__weakref__</code><a class="headerlink" href="#galsim.utilities.AttributeDict.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="math-calculations">
<h2>Math Calculations<a class="headerlink" href="#math-calculations" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="galsim.utilities.horner">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">horner</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">coef</em>, <em class="sig-param">dtype=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#horner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.horner" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate univariate polynomial using Horner’s method.</p>
<p>I.e., take A + Bx + Cx^2 + Dx^3 and evaluate it as
A + x(B + x(C + x(D)))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – A numpy array of values at which to evaluate the polynomial.</p></li>
<li><p><strong>coef</strong> – Polynomial coefficients of increasing powers of x.</p></li>
<li><p><strong>dtype</strong> – Optionally specify the dtype of the return array. [default: None]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a numpy array of the evaluated polynomial.  Will be the same shape as x.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.horner2d">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">horner2d</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">coefs</em>, <em class="sig-param">dtype=None</em>, <em class="sig-param">triangle=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#horner2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.horner2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate bivariate polynomial using nested Horner’s method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – A numpy array of the x values at which to evaluate the polynomial.</p></li>
<li><p><strong>y</strong> – A numpy array of the y values at which to evaluate the polynomial.</p></li>
<li><p><strong>coefs</strong> – 2D array-like of coefficients in increasing powers of x and y.
The first axis corresponds to increasing the power of y, and the second to
increasing the power of x.</p></li>
<li><p><strong>dtype</strong> – Optionally specify the dtype of the return array. [default: None]</p></li>
<li><p><strong>triangle</strong> – If True, then the coefs are only non-zero in the upper-left triangle
of the array. [default: False]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a numpy array of the evaluated polynomial.  Will be the same shape as x and y.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.binomial">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">binomial</code><span class="sig-paren">(</span><em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#binomial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.binomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return xy coefficients of (ax + by)^n ordered by descending powers of a.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># (x + y)^3 = 1 x^3 + 3 x^2 y + 3 x y^2 + 1 y^3</span>
<span class="o">&gt;&gt;&gt;</span>  <span class="nb">print</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">])</span>


<span class="c1"># (2 x + y)^3 = 8 x^3 + 12 x^2 y + 6 x y^2 + 1 y^3</span>
<span class="o">&gt;&gt;&gt;</span>  <span class="nb">print</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">8.</span><span class="p">,</span>  <span class="mf">12.</span><span class="p">,</span>  <span class="mf">6.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – First scalar in binomial to be expanded.</p></li>
<li><p><strong>b</strong> – Second scalar in binomial to be expanded.</p></li>
<li><p><strong>n</strong> – Exponent of expansion.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of coefficients in expansion.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.nCr">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">nCr</code><span class="sig-paren">(</span><em class="sig-param">n</em>, <em class="sig-param">r</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#nCr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.nCr" title="Permalink to this definition">¶</a></dt>
<dd><p>Combinations.  I.e., the number of ways to choose <code class="docutils literal notranslate"><span class="pre">r</span></code> distiguishable things from <code class="docutils literal notranslate"><span class="pre">n</span></code>
distinguishable things.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>The number of options to choose from.</strong> (<em>n</em>) – </p></li>
<li><p><strong>The number of items to choose</strong> (<em>r</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>nCr, the (n,r) binomial coefficient.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Python 3, the factorial function was improved such that doing this the direct way
of calculating n! / (r! (n-r)!) seems to be the fastest algorith.  In Python 2, for
largish values of n, a more complicated algorithm that avoided large integers was
faster.  This function uses the direct method for both – we don’t bother to check the
version of Python to potentially select a different algorithm in the two cases.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.rotate_xy">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">rotate_xy</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#rotate_xy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.rotate_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates points in the xy-Cartesian plane counter-clockwise through an angle <code class="docutils literal notranslate"><span class="pre">theta</span></code> about
the origin of the Cartesian coordinate system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – NumPy array of input x coordinates</p></li>
<li><p><strong>y</strong> – NumPy array of input y coordinates</p></li>
<li><p><strong>theta</strong> – Rotation angle (+ve counter clockwise) as an <a class="reference internal" href="coord.html#galsim.Angle" title="galsim.Angle"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Angle</span></code></a> instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the rotated coordinates (x_rot,y_rot).</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.g1g2_to_e1e2">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">g1g2_to_e1e2</code><span class="sig-paren">(</span><em class="sig-param">g1</em>, <em class="sig-param">g2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#g1g2_to_e1e2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.g1g2_to_e1e2" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function for going from (g1, g2) -&gt; (e1, e2).</p>
<p>Here g1 and g2 are reduced shears, and e1 and e2 are distortions - see <a class="reference internal" href="shear.html#galsim.Shear" title="galsim.Shear"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Shear</span></code></a>
for definitions of reduced shear and distortion in terms of axis ratios or other ways of
specifying ellipses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g1</strong> – First reduced shear component</p></li>
<li><p><strong>g2</strong> – Second reduced shear component</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the corresponding distortions, e1 and e2.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="utilities-related-to-numpy-functions">
<h2>Utilities Related to NumPy Functions<a class="headerlink" href="#utilities-related-to-numpy-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="galsim.utilities.printoptions">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">printoptions</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#printoptions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.printoptions" title="Permalink to this definition">¶</a></dt>
<dd><p>A context manager for using different numpy printoptions temporarily</p>
<p>From <a class="reference external" href="http://stackoverflow.com/questions/2891790/pretty-printing-of-numpy-array">http://stackoverflow.com/questions/2891790/pretty-printing-of-numpy-array</a></p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">long_arr</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">long_arr</span><span class="p">)</span>  <span class="c1"># Doesn&#39;t omit values in the middle of the array</span>
<span class="nb">print</span><span class="p">(</span><span class="n">long_arr</span><span class="p">)</span>  <span class="c1"># If the array is long enough, will use ... in the middle.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It seems Numpy finally added this feature in version 1.15.  So this is probably
equivalent to using <code class="docutils literal notranslate"><span class="pre">numpy.prinoptions</span></code> instead of <code class="docutils literal notranslate"><span class="pre">galsim.utilities.printoptions</span></code>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.roll2d">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">roll2d</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">shape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#roll2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.roll2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a 2D roll (circular shift) on a supplied 2D NumPy array, conveniently.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> – The NumPy array to be circular shifted.</p></li>
<li><p><strong>shape</strong> – (iroll, jroll) The roll in the i and j dimensions, respectively.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the rolled array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.kxky">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">kxky</code><span class="sig-paren">(</span><em class="sig-param">array_shape=(256</em>, <em class="sig-param">256)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#kxky"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.kxky" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the tuple (kx, ky) corresponding to the DFT of a unit integer-sampled array of
input shape.</p>
<p>Uses the FFTW conventions for Fourier space, so k varies in approximate range (-pi, pi],
and the (0, 0) array element corresponds to (kx, ky) = (0, 0).</p>
<p>See also the docstring for np.fftfreq, which uses the same DFT convention, and is called here,
but misses a factor of pi.</p>
<p>Adopts NumPy array index ordering so that the trailing axis corresponds to kx, rather than
the leading axis as would be expected in IDL/Fortran.  See docstring for <code class="docutils literal notranslate"><span class="pre">numpy.meshgrid</span></code>
which also uses this convention.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>array_shape</strong> – The NumPy array shape desired for kx, ky.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>kx, ky</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="other-helper-functions">
<h2>Other Helper Functions<a class="headerlink" href="#other-helper-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="galsim.utilities.isinteger">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">isinteger</code><span class="sig-paren">(</span><em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#isinteger"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.isinteger" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a value is an integer type (including np.int64, long, etc.)</p>
<p>Specifically, it checks whether value == int(value).</p>
<dl class="simple">
<dt>Parameter:</dt><dd><p>value:      The value to be checked whether it is an integer</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if the value is an integer type, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.listify">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">listify</code><span class="sig-paren">(</span><em class="sig-param">arg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#listify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.listify" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn argument into a list if not already iterable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> – An argument that may be a lit or a single item</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[arg] if arg was not already a list, otherwise arg.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.dol_to_lod">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">dol_to_lod</code><span class="sig-paren">(</span><em class="sig-param">dol</em>, <em class="sig-param">N=None</em>, <em class="sig-param">scalar_string=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#dol_to_lod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.dol_to_lod" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate list of dicts from dict of lists (with broadcasting).
Specifically, generate “scalar-valued” kwargs dictionaries from a kwarg dictionary with values
that are length-N lists, or possibly length-1 lists or scalars that should be broadcasted up to
length-N lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dol</strong> – A dict of lists</p></li>
<li><p><strong>N</strong> – The length of the lists if known in advance. [default: None, which will
determine the maximum length of the lists for you]</p></li>
<li><p><strong>scalar_string</strong> – Whether strings in the input list should be treated as scalars (and thus
broadcast to each item in the output) or not (in which case, they will
be treated as lists of characters) [default: True]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of dicts</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.functionize">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">functionize</code><span class="sig-paren">(</span><em class="sig-param">f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#functionize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.functionize" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorate a function <code class="docutils literal notranslate"><span class="pre">f</span></code> which accepts scalar positional or keyword arguments, to accept
arguments that can be either scalars or _functions_.  If the arguments include univariate
(N-variate) functions, then the output will be a univariate (N-variate) function.  While it’s
okay to mix scalar and N-variate function arguments, it is an error to mix N-variate and
M-variate function arguments.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>      <span class="c1"># Function of two scalars.</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decorated</span> <span class="o">=</span> <span class="n">functionize</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>   <span class="c1"># Function of two scalars, functions, or a mix.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">)</span>  <span class="c1"># Generates a TypeError</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">decorated</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># Scalar args returns a scalar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">decorated</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">u</span><span class="p">)</span>  <span class="c1"># Univariate argument leads to a univariate output.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>  <span class="c1"># 7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">decorated</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">:</span> <span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">)</span>  <span class="c1"># Bivariate argument leads to a bivariate output.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>  <span class="c1"># 2 + (5*7) = 37</span>
</pre></div>
</div>
<p>We can use arguments that accept keyword arguments too:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">v</span> <span class="o">=</span> <span class="mf">6.0</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">u</span> <span class="o">/</span> <span class="n">v</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">decorated</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">f2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>  <span class="c1"># 2 + (12./6) = 4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># 2 + (12/4) = 5</span>
</pre></div>
</div>
<p>Note that you can also use python’s decorator syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@functionize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> – The function to be decorated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorated function.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.ensure_dir">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">ensure_dir</code><span class="sig-paren">(</span><em class="sig-param">target</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#ensure_dir"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.ensure_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure the directory for the target location exists, watching for a race condition</p>
<p>In particular check if the OS reported that the directory already exists when running
makedirs, which can happen if another process creates it before this one can</p>
<dl class="simple">
<dt>Parameter:</dt><dd><p>target:     The file name for which to ensure that all necessary directories exist.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="galsim-specific-helper-functions">
<h2>GalSim-specific Helper Functions<a class="headerlink" href="#galsim-specific-helper-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="galsim.utilities.interleaveImages">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">interleaveImages</code><span class="sig-paren">(</span><em class="sig-param">im_list</em>, <em class="sig-param">N</em>, <em class="sig-param">offsets</em>, <em class="sig-param">add_flux=True</em>, <em class="sig-param">suppress_warnings=False</em>, <em class="sig-param">catch_offset_errors=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#interleaveImages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.interleaveImages" title="Permalink to this definition">¶</a></dt>
<dd><p>Interleaves the pixel values from two or more images and into a single larger image.</p>
<p>This routine converts a list of images taken at a series of (uniform) dither offsets into a
single higher resolution image, where the value in each final pixel is the observed pixel
value from exactly one of the original images.  It can be used to build a Nyquist-sampled image
from a set of images that were observed with pixels larger than the Nyquist scale.</p>
<p>In the original observed images, the integration of the surface brightness over the pixels is
equivalent to convolution by the pixel profile and then sampling at the centers of the pixels.
This procedure simulates an observation sampled at a higher resolution than the original images,
while retaining the original pixel convolution.</p>
<p>Such an image can be obtained in a fairly simple manner in simulations of surface brightness
profiles by convolving them explicitly with the native pixel response and setting a lower
sampling scale (or higher sampling rate) using the <code class="docutils literal notranslate"><span class="pre">pixel_scale</span></code> argument in
<a class="reference internal" href="gsobject.html#galsim.GSObject.drawImage" title="galsim.GSObject.drawImage"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">GSObject.drawImage</span></code></a> routine and setting the <code class="docutils literal notranslate"><span class="pre">method</span></code> parameter to ‘no_pixel’.</p>
<p>However, pixel level detector effects can be included only on images drawn at the native pixel
scale, which happen to be undersampled in most cases. Nyquist-sampled images that also include
the effects of detector non-idealities can be obtained by drawing multiple undersampled images
(with the detector effects included) that are offset from each other by a fraction of a pixel.</p>
<p>This is similar to other procedures that build a higher resolution image from a set of low
resolution images, such as MultiDrizzle and IMCOM. A disadvantage of this routine compared to
ther others is that the images must be offset in equal steps in each direction. This is
difficult to acheive with real observations but can be precisely acheived in a series of
simulated images.</p>
<p>An advantage of this procedure is that the noise in the final image is not correlated as the
pixel values are each taken from just a single input image. Thus, this routine preserves the
noise properties of the pixels.</p>
<p>Here’s an example script using this routine:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gal</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">2.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DX</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DX</span> <span class="o">-=</span> <span class="n">DX</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im_list</span><span class="p">,</span> <span class="n">offsets</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">dx</span> <span class="ow">in</span> <span class="n">DX</span><span class="p">:</span>
<span class="go">    ... offset = galsim.PositionD(dx,0.0)</span>
<span class="go">    ... offsets.append(offset)</span>
<span class="go">    ... im = galsim.Image(16,16)</span>
<span class="go">    ... gal.drawImage(image=im,offset=offset,scale=1.0)</span>
<span class="go">    ... im.applyNonlinearity(lambda x: x - 0.01*x**2) # detector effects</span>
<span class="go">    ... im_list.append(im)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">utilities</span><span class="o">.</span><span class="n">interleaveImages</span><span class="p">(</span><span class="n">im_list</span><span class="o">=</span><span class="n">im_list</span><span class="p">,</span><span class="n">N</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">offsets</span><span class="o">=</span><span class="n">offsets</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_list</strong> – A list containing the <a class="reference internal" href="image_class.html#galsim.Image" title="galsim.Image"><code class="xref any py py-class docutils literal notranslate"><span class="pre">galsim.Image</span></code></a> instances to be interleaved.</p></li>
<li><p><strong>N</strong> – Number of images to interleave in either directions. It can be of
type <code class="docutils literal notranslate"><span class="pre">int</span></code> if equal number of images are interleaved in both
directions or a list or tuple of two integers, containing the number
of images in x and y directions respectively.</p></li>
<li><p><strong>offsets</strong> – A list containing the offsets as galsim.PositionD instances
corresponding to every image in <code class="docutils literal notranslate"><span class="pre">im_list</span></code>. The offsets must be
spaced equally and must span an entire pixel area. The offset
values must be symmetric around zero, hence taking positive and
negative values, with upper and lower limits of +0.5 and -0.5
(limit values excluded).</p></li>
<li><p><strong>add_flux</strong> – Should the routine add the fluxes of all the images (True) or
average them (False)? [default: True]</p></li>
<li><p><strong>suppress_warnings</strong> – Suppresses the warnings about the pixel scale of the output, if
True.  [default: False]</p></li>
<li><p><strong>catch_offset_errors</strong> – Checks for the consistency of <code class="docutils literal notranslate"><span class="pre">offsets</span></code> with <code class="docutils literal notranslate"><span class="pre">N</span></code> and raises
errors if inconsistencies found (True). Recommended, but could slow
down the routine a little. [default: True]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the interleaved <a class="reference internal" href="image_class.html#galsim.Image" title="galsim.Image"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Image</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.deInterleaveImage">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">deInterleaveImage</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">N</em>, <em class="sig-param">conserve_flux=False</em>, <em class="sig-param">suppress_warnings=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#deInterleaveImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.deInterleaveImage" title="Permalink to this definition">¶</a></dt>
<dd><p>The routine to do the opposite of what <a class="reference internal" href="#galsim.utilities.interleaveImages" title="galsim.utilities.interleaveImages"><code class="xref any py py-func docutils literal notranslate"><span class="pre">interleaveImages</span></code></a> routine does. It generates a
(uniform) dither sequence of low resolution images from a high resolution image.</p>
<p>Many pixel level detector effects, such as interpixel capacitance, persistence, charge
diffusion etc. can be included only on images drawn at the native pixel scale, which happen to
be undersampled in most cases. Nyquist-sampled images that also include the effects of detector
non-idealities can be obtained by drawing multiple undersampled images (with the detector
effects included) that are offset from each other by a fraction of a pixel. If the offsets are
uniformly spaced, then images can be combined using <a class="reference internal" href="#galsim.utilities.interleaveImages" title="galsim.utilities.interleaveImages"><code class="xref any py py-func docutils literal notranslate"><span class="pre">interleaveImages</span></code></a> into a Nyquist-sampled
image.</p>
<p>Drawing multiple low resolution images of a light profile can be a lot slower than drawing a
high resolution image of the same profile, even if the total number of pixels is the same. A
uniformly offset dither sequence can be extracted from a well-resolved image that is drawn by
convolving the surface brightness profile explicitly with the native pixel response and setting
a lower sampling scale (or higher sampling rate) using the <code class="docutils literal notranslate"><span class="pre">pixel_scale</span></code> argument in
<a class="reference internal" href="gsobject.html#galsim.GSObject.drawImage" title="galsim.GSObject.drawImage"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">GSObject.drawImage</span></code></a> routine and setting the <code class="docutils literal notranslate"><span class="pre">method</span></code> parameter to ‘no_pixel’.</p>
<p>Here is an example script using this routine:</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gal</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mf">2.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gal_pix</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">Convolve</span><span class="p">([</span><span class="n">gal</span><span class="p">,</span><span class="n">galsim</span><span class="o">.</span><span class="n">Pixel</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">gal_pix</span><span class="o">.</span><span class="n">drawImage</span><span class="p">(</span><span class="n">gal_pix</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="n">n</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;no_pixel&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im_list</span><span class="p">,</span> <span class="n">offsets</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">utilities</span><span class="o">.</span><span class="n">deInterleaveImage</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="n">N</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">im</span> <span class="ow">in</span> <span class="n">im_list</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">im</span><span class="o">.</span><span class="n">applyNonlinearity</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">-</span><span class="mf">0.01</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#detector effects</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_new</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">utilities</span><span class="o">.</span><span class="n">interleaveImages</span><span class="p">(</span><span class="n">im_list</span><span class="p">,</span><span class="n">N</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">offsets</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> – Input image from which lower resolution images are extracted.</p></li>
<li><p><strong>N</strong> – Number of images extracted in either directions. It can be of type
‘int’ if equal number of images are extracted in both directions or a
list or tuple of two integers, containing the number of images in x
and y directions respectively.</p></li>
<li><p><strong>conserve_flux</strong> – Should the routine output images that have, on average, same total
pixel values as the input image (True) or should the pixel values
summed over all the images equal the sum of pixel values of the input
image (False)? [default: False]</p></li>
<li><p><strong>suppress_warnings</strong> – Suppresses the warnings about the pixel scale of the output, if True.
[default: False]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of images (<a class="reference internal" href="image_class.html#galsim.Image" title="galsim.Image"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Image</span></code></a>) and offsets (<a class="reference internal" href="pos.html#galsim.PositionD" title="galsim.PositionD"><code class="xref any py py-class docutils literal notranslate"><span class="pre">PositionD</span></code></a>) to reconstruct the input image using
<a class="reference internal" href="#galsim.utilities.interleaveImages" title="galsim.utilities.interleaveImages"><code class="xref any py py-func docutils literal notranslate"><span class="pre">interleaveImages</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.thin_tabulated_values">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">thin_tabulated_values</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">f</em>, <em class="sig-param">rel_err=0.0001</em>, <em class="sig-param">trim_zeros=True</em>, <em class="sig-param">preserve_range=True</em>, <em class="sig-param">fast_search=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#thin_tabulated_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.thin_tabulated_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove items from a set of tabulated f(x) values so that the error in the integral is still
accurate to a given relative accuracy.</p>
<p>The input <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">f</span></code> values can be lists, NumPy arrays, or really anything that can be
converted to a NumPy array.  The new lists will be output as numpy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – The <code class="docutils literal notranslate"><span class="pre">x</span></code> values in the f(x) tabulation.</p></li>
<li><p><strong>f</strong> – The <code class="docutils literal notranslate"><span class="pre">f</span></code> values in the f(x) tabulation.</p></li>
<li><p><strong>rel_err</strong> – The maximum relative error to allow in the integral from the removal.
[default: 1.e-4]</p></li>
<li><p><strong>trim_zeros</strong> – Remove redundant leading and trailing points where f=0?  (The last
leading point with f=0 and the first trailing point with f=0 will be
retained).  Note that if both trim_leading_zeros and preserve_range are
True, then the only the range of <code class="docutils literal notranslate"><span class="pre">x</span></code> <em>after</em> zero trimming is preserved.
[default: True]</p></li>
<li><p><strong>preserve_range</strong> – Should the original range of <code class="docutils literal notranslate"><span class="pre">x</span></code> be preserved? (True) Or should the ends
be trimmed to include only the region where the integral is
significant? (False)  [default: True]</p></li>
<li><p><strong>fast_search</strong> – If set to True, then the underlying algorithm will use a relatively fast
O(N) algorithm to select points to include in the thinned approximation.
If set to False, then a slower O(N^2) algorithm will be used.  We have
found that the slower algorithm tends to yield a thinned representation
that retains fewer samples while still meeting the relative error
requirement.  [default: True]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple of lists (x_new, y_new) with the thinned tabulation.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.old_thin_tabulated_values">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">old_thin_tabulated_values</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">f</em>, <em class="sig-param">rel_err=0.0001</em>, <em class="sig-param">preserve_range=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#old_thin_tabulated_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.old_thin_tabulated_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove items from a set of tabulated f(x) values so that the error in the integral is still
accurate to a given relative accuracy.</p>
<p>The input <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">f</span></code> values can be lists, NumPy arrays, or really anything that can be
converted to a NumPy array.  The new lists will be output as python lists.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Issue #739, Josh wrote <a class="reference internal" href="#galsim.utilities.thin_tabulated_values" title="galsim.utilities.thin_tabulated_values"><code class="xref any py py-func docutils literal notranslate"><span class="pre">thin_tabulated_values</span></code></a>  as a replacement for this function,
which had been buggy – not actually hitting its target relative accuracy.  So on the
same issue, Mike fixed this algorithm to at least work correctly.</p>
<p>However, we recommend using the above algorithm, since it keeps fewer sample locations
for a given <code class="docutils literal notranslate"><span class="pre">rel_err</span></code> than the old algorithm.</p>
<p>On the other hand, the old algorithm (this one) may be quite a bit faster, so we retain
it here in case there is a use case where it is more appropriate.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – The <code class="docutils literal notranslate"><span class="pre">x</span></code> values in the f(x) tabulation.</p></li>
<li><p><strong>f</strong> – The <code class="docutils literal notranslate"><span class="pre">f</span></code> values in the f(x) tabulation.</p></li>
<li><p><strong>rel_err</strong> – The maximum relative error to allow in the integral from the removal.
[default: 1.e-4]</p></li>
<li><p><strong>preserve_range</strong> – Should the original range of <code class="docutils literal notranslate"><span class="pre">x</span></code> be preserved? (True) Or should the ends
be trimmed to include only the region where the integral is
significant? (False)  [default: False]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a tuple of lists (x_new, y_new) with the thinned tabulation.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.parse_pos_args">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">parse_pos_args</code><span class="sig-paren">(</span><em class="sig-param">args</em>, <em class="sig-param">kwargs</em>, <em class="sig-param">name1</em>, <em class="sig-param">name2</em>, <em class="sig-param">integer=False</em>, <em class="sig-param">others=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#parse_pos_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.parse_pos_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the args and kwargs of a function call to be some kind of position.</p>
<p>We allow four options:</p>
<blockquote>
<div><p>f(x,y)
f(galsim.PositionD(x,y)) or f(galsim.PositionI(x,y))
f( (x,y) )  (or any indexable thing)
f(name1=x, name2=y)</p>
</div></blockquote>
<p>If the inputs must be integers, set <code class="docutils literal notranslate"><span class="pre">integer=True</span></code>.
If there are other args/kwargs to parse after these, then their names should be
be given as the parameter <code class="docutils literal notranslate"><span class="pre">others</span></code>, which are passed back in a tuple after the position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – The args of the original function.</p></li>
<li><p><strong>kwargs</strong> – The kwargs of the original function.</p></li>
<li><p><strong>name1</strong> – The allowed kwarg for the first coordinate.</p></li>
<li><p><strong>name2</strong> – The allowed kwarg for the second coordinate.</p></li>
<li><p><strong>integer</strong> – Whether to return a <a class="reference internal" href="pos.html#galsim.PositionI" title="galsim.PositionI"><code class="xref any py py-class docutils literal notranslate"><span class="pre">PositionI</span></code></a> rather than a <a class="reference internal" href="pos.html#galsim.PositionD" title="galsim.PositionD"><code class="xref any py py-class docutils literal notranslate"><span class="pre">PositionD</span></code></a>. [default: False]</p></li>
<li><p><strong>others</strong> – If given, other values to also parse and return from the kwargs. [default: []]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a <a class="reference internal" href="pos.html#galsim.Position" title="galsim.Position"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Position</span></code></a> instance, possibly also with other values if <code class="docutils literal notranslate"><span class="pre">others</span></code> is given.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.rand_arr">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">rand_arr</code><span class="sig-paren">(</span><em class="sig-param">shape</em>, <em class="sig-param">deviate</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#rand_arr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.rand_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to make a 2d array of random deviates (of any sort).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> – A list of length 2, indicating the desired 2d array dimensions</p></li>
<li><p><strong>deviate</strong> – Any GalSim deviate (see random.py) such as <a class="reference internal" href="deviate.html#galsim.UniformDeviate" title="galsim.UniformDeviate"><code class="xref any py py-class docutils literal notranslate"><span class="pre">UniformDeviate</span></code></a>, <a class="reference internal" href="deviate.html#galsim.GaussianDeviate" title="galsim.GaussianDeviate"><code class="xref any py py-class docutils literal notranslate"><span class="pre">GaussianDeviate</span></code></a>,
etc. to be used to generate random numbers</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a NumPy array of the desired dimensions with random numbers generated using the
supplied deviate.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.convert_interpolant">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">convert_interpolant</code><span class="sig-paren">(</span><em class="sig-param">interpolant</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#convert_interpolant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.convert_interpolant" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a given interpolant to an <a class="reference internal" href="interpolant.html#galsim.Interpolant" title="galsim.Interpolant"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Interpolant</span></code></a> if it is given as a string.</p>
<dl class="simple">
<dt>Parameter:</dt><dd><p>interpolant:    Either an <a class="reference internal" href="interpolant.html#galsim.Interpolant" title="galsim.Interpolant"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Interpolant</span></code></a> or a string to convert.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>an <a class="reference internal" href="interpolant.html#galsim.Interpolant" title="galsim.Interpolant"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Interpolant</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.structure_function">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">structure_function</code><span class="sig-paren">(</span><em class="sig-param">image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#structure_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.structure_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the angularly-averaged structure function of a 2D random field.</p>
<p>The angularly-averaged structure function D(r) of the 2D field phi is defined as:</p>
<div class="math notranslate nohighlight">
\[D(|r|) = \langle |phi(x) - phi(x+r)|^2 \rangle\]</div>
<p>where the x and r on the RHS are 2D vectors, but the <span class="math notranslate nohighlight">\(|r|\)</span> on the LHS is just a scalar
length.</p>
<p>The image must have its <code class="docutils literal notranslate"><span class="pre">scale</span></code> attribute defined.  It will be used in the calculations to
set the scale of the radial distances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image</strong> – <a class="reference internal" href="image_class.html#galsim.Image" title="galsim.Image"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Image</span></code></a> containing random field realization.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A python callable mapping a separation length r to the estimate of the structure
function D(r).</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.combine_wave_list">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">combine_wave_list</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#combine_wave_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.combine_wave_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine wave_list attributes of all objects in obj_list while respecting blue_limit and
red_limit attributes.  Should work with any combination of <a class="reference internal" href="sed.html#galsim.SED" title="galsim.SED"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SED</span></code></a>, <a class="reference internal" href="bandpass.html#galsim.Bandpass" title="galsim.Bandpass"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Bandpass</span></code></a>, and
<a class="reference internal" href="chromaticobject.html#galsim.ChromaticObject" title="galsim.ChromaticObject"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ChromaticObject</span></code></a> instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj_list</strong> – List of <a class="reference internal" href="sed.html#galsim.SED" title="galsim.SED"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SED</span></code></a>, <a class="reference internal" href="bandpass.html#galsim.Bandpass" title="galsim.Bandpass"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Bandpass</span></code></a>, or <a class="reference internal" href="chromaticobject.html#galsim.ChromaticObject" title="galsim.ChromaticObject"><code class="xref any py py-class docutils literal notranslate"><span class="pre">ChromaticObject</span></code></a> instances.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>wave_list, blue_limit, red_limit</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.math_eval">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">math_eval</code><span class="sig-paren">(</span><em class="sig-param">str</em>, <em class="sig-param">other_modules=()</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#math_eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.math_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a string that may include numpy, np, or math commands.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>str</strong> – The string to evaluate</p></li>
<li><p><strong>Other modules in addition to numpy</strong><strong>, </strong><strong>np</strong><strong>, </strong><strong>math to import as well.</strong> (<em>other_modules.</em>) – Should be given as a list of strings.  [default: None]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whatever the string evaluates to.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.unweighted_moments">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">unweighted_moments</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">origin=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#unweighted_moments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.unweighted_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes unweighted 0th, 1st, and 2nd moments in image coordinates.  Respects image bounds,
but ignores any scale or wcs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> – <a class="reference internal" href="image_class.html#galsim.Image" title="galsim.Image"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Image</span></code></a> from which to compute moments</p></li>
<li><p><strong>origin</strong> – Optional origin in image coordinates used to compute Mx and My
[default: galsim.PositionD(0, 0)].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dict with entries for [M0, Mx, My, Mxx, Myy, Mxy]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.unweighted_shape">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">unweighted_shape</code><span class="sig-paren">(</span><em class="sig-param">arg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#unweighted_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.unweighted_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes unweighted second moment size and ellipticity given either an image or a dict of
unweighted moments.</p>
<dl class="simple">
<dt>The size is:</dt><dd><p>rsqr = Mxx+Myy</p>
</dd>
<dt>The ellipticities are:</dt><dd><p>e1 = (Mxx-Myy) / rsqr
e2 = 2*Mxy / rsqr</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> – Either a <a class="reference internal" href="image_class.html#galsim.Image" title="galsim.Image"><code class="xref any py py-class docutils literal notranslate"><span class="pre">galsim.Image</span></code></a> or the output of unweighted_moments(image).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dict with entries for [rsqr, e1, e2]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.rand_with_replacement">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">rand_with_replacement</code><span class="sig-paren">(</span><em class="sig-param">n</em>, <em class="sig-param">n_choices</em>, <em class="sig-param">rng</em>, <em class="sig-param">weight=None</em>, <em class="sig-param">_n_rng_calls=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#rand_with_replacement"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.rand_with_replacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Select some number of random choices from a list, with replacement, using a supplied RNG.</p>
<p><code class="docutils literal notranslate"><span class="pre">n</span></code> random choices with replacement are made assuming that those choices should range from 0
to <code class="docutils literal notranslate"><span class="pre">n_choices-1</span></code>, so they can be used as indices in a list/array.  If <code class="docutils literal notranslate"><span class="pre">weight</span></code> is supplied,
then it should be an array of length <code class="docutils literal notranslate"><span class="pre">n_choices</span></code> that ranges from 0-1, and can be used to
make weighted choices from the list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – Number of random selections to make.</p></li>
<li><p><strong>n_choices</strong> – Number of entries from which to choose.</p></li>
<li><p><strong>rng</strong> – RNG to use.  Must a <a class="reference internal" href="deviate.html#galsim.BaseDeviate" title="galsim.BaseDeviate"><code class="xref any py py-class docutils literal notranslate"><span class="pre">galsim.BaseDeviate</span></code></a> instance.</p></li>
<li><p><strong>weight</strong> – Optional list of weight factors to use for weighting the selection of
random indices.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a NumPy array of length n containing the integer-valued indices that were selected.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.check_share_file">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">check_share_file</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">subdir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#check_share_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.check_share_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Find <a class="reference internal" href="sed.html#galsim.SED" title="galsim.SED"><code class="xref any py py-class docutils literal notranslate"><span class="pre">SED</span></code></a> or <a class="reference internal" href="bandpass.html#galsim.Bandpass" title="galsim.Bandpass"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Bandpass</span></code></a> file, possibly adding share_dir/subdir.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – The file name to look for</p></li>
<li><p><strong>subdir</strong> – The subdirectory of <a class="reference internal" href="shared.html#galsim.meta_data.share_dir" title="galsim.meta_data.share_dir"><code class="xref any py py-data docutils literal notranslate"><span class="pre">galsim.meta_data.share_dir</span></code></a> where this file might be.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True, correct_filename      if the file was found
False, ‘’                   if not</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.utilities.find_out_of_bounds_position">
<code class="sig-prename descclassname">galsim.utilities.</code><code class="sig-name descname">find_out_of_bounds_position</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">bounds</em>, <em class="sig-param">grid=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/utilities.html#find_out_of_bounds_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.utilities.find_out_of_bounds_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Given arrays of x and y values that are known to contain at least one
position that is out-of-bounds of the given bounds instance, return one
such PositionD.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Array of x values</p></li>
<li><p><strong>y</strong> – Array of y values</p></li>
<li><p><strong>bounds</strong> – <a class="reference internal" href="bounds.html#galsim.Bounds" title="galsim.Bounds"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Bounds</span></code></a> instance</p></li>
<li><p><strong>grid</strong> – Bool indicating whether to check the outer product of x and y
(grid=True), or each sequential pair of x and y (grid=False).
If the latter, then x and y should have the same shape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a <a class="reference internal" href="pos.html#galsim.PositionD" title="galsim.PositionD"><code class="xref any py py-class docutils literal notranslate"><span class="pre">PositionD</span></code></a> from x and y that is out-of-bounds of bounds.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="errors.html" class="btn btn-neutral float-right" title="Errors and Warnings" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cd.html" class="btn btn-neutral float-left" title="Charge Deflection Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, GalSim-developers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>