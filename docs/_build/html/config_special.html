

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Special Fields &mdash; GalSim 2.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The galsim Executable" href="config_galsim.html" />
    <link rel="prev" title="Config Values" href="config_values.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> GalSim
          

          
          </a>

          
            
            
              <div class="version">
                2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">Images and Related Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="sb.html">Surface Brightness Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="wcs.html">World Coordinate Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="random.html">Noise and Random Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="chromatic.html">Wavelength-dependent Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="wl.html">Weak Lensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="photon.html">Photon Shooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="coord.html">Angles and Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Helper Functions and Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">Errors and Warnings</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="config.html">The Config Module</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config_top.html">Top Level Fields</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Special Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="config_galsim.html">The galsim Executable</a></li>
<li class="toctree-l2"><a class="reference internal" href="config_process.html">Config Processing From Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hsm.html">The HSM Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="des.html">The DES Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="wfirst.html">The WFIRST Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="shared.html">Shared Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Revision History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GalSim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="config.html">The Config Module</a> &raquo;</li>
        
      <li>Special Fields</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/config_special.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="special-fields">
<h1>Special Fields<a class="headerlink" href="#special-fields" title="Permalink to this headline">Â¶</a></h1>
<p>There are a couple of other top level fields that act more in a support role, rather than being
part of the main processing.</p>
<p><strong>modules</strong>:</p>
<p>Almost all aspects of the file building can be customized by the user if the existing GalSim
types do not do precisely what you need.  How to do this is described in the pages about
each of the different top-level fields.  In all cases, you need to tell GalSim what Python
modules to load at the start of processing to get the implementations of your custom types.
That is what this field is for.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">modules</span></code> field should contain a list of modules that GalSim should import before
processing the rest of the config file.  These modules can be either in the current directory
where you are running the code or installed in your Python distro.  (Or technically, they
need to be located in a directory in <code class="docutils literal notranslate"><span class="pre">sys.path</span></code>.)</p>
<p>See:</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="_downloads/af323aafc94b32920083be6fa7e12788/meds.yaml"><code class="xref download docutils literal notranslate"><span class="pre">meds.yaml</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="_downloads/c89d2f3d39fb6d561511338ec27c7757/blendset.yaml"><code class="xref download docutils literal notranslate"><span class="pre">blendset.yaml</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="_downloads/f2b30d40a89c1c39718c2a64f0894b58/cgc.yaml"><code class="xref download docutils literal notranslate"><span class="pre">cgc.yaml</span></code></a></p></li>
</ul>
<p>for some examples of this field.</p>
<p><strong>eval_variables</strong>:</p>
<p>Sometimes, it can be useful to define some configuration parameters right at the top of the
config file that might be used farther down in the file somewhere to highlight them.
Or sometimes, there are calculations that are needed by several different values in the
config file, which you only want to calculate once.</p>
<p>You can put such values in a top-level <code class="docutils literal notranslate"><span class="pre">eval_variables</span></code> field.  They work just like
variables that you define for <a class="reference internal" href="config_values.html#eval-type"><span class="std std-ref">Eval</span></a>
items, but they can be placed separately from those evaluations.</p>
<p>For examples of this field, see:</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="_downloads/ee4efa8d0c4fc8f5921708a6325ca98f/demo11.yaml"><code class="xref download docutils literal notranslate"><span class="pre">demo11.yaml</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="_downloads/46c5dd7b07579c6dff7a9d685ec2532e/draw_psf.yaml"><code class="xref download docutils literal notranslate"><span class="pre">draw_psf.yaml</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="_downloads/f2b30d40a89c1c39718c2a64f0894b58/cgc.yaml"><code class="xref download docutils literal notranslate"><span class="pre">cgc.yaml</span></code></a></p></li>
</ul>
<p><strong>template</strong></p>
<p>This feature directs the config processing to first load in some other file (or specific
field with that file) and then possibly modify some components of that dict.</p>
<p>To load in some other config file named <code class="docutils literal notranslate"><span class="pre">config.yaml</span></code>, you would write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p>If you only want to load a particular field from that file, say the <code class="docutils literal notranslate"><span class="pre">image</span></code> field, you could
write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">yaml</span><span class="p">:</span><span class="n">image</span>
</pre></div>
</div>
<p>The template field may appear anywhere in the config file.  Wherever it appears, the contents
of the other file will be a starting point for that part of the current config dict,
but you can replace
or add values by specifying new values for some of the fields.  Fields that are not at
the top level are specified using a <code class="docutils literal notranslate"><span class="pre">.</span></code> to proceed down the levels of the config hierarchy.
e.g. <code class="docutils literal notranslate"><span class="pre">image.noise.sky_level</span></code> refers to <code class="docutils literal notranslate"><span class="pre">config['image']['noise']['sky_level']</span></code>.</p>
<p>For example, if you have a simulation defined in <code class="docutils literal notranslate"><span class="pre">my_sim.yaml</span></code>, and you want to make another
simulation that is identical, except you want Sersic galaxies instead of Exponential galaxies say,
you could write a new file that looks something like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">template </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my_sim.yaml</span>
<span class="nt">gal</span><span class="p">:</span>
    <span class="nt">type </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Sersic</span>
    <span class="nt">n </span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt"> type </span><span class="p">:</span> <span class="nv">Random</span><span class="p p-Indicator">,</span><span class="nt"> min </span><span class="p">:</span> <span class="nv">1</span><span class="p p-Indicator">,</span><span class="nt"> max</span><span class="p">:</span> <span class="nv">4</span> <span class="p p-Indicator">}</span>
    <span class="nt">half_light_radius </span><span class="p">:</span>
        <span class="nt">template </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my_sim.yaml:gal.half_light_radius</span>
    <span class="nt">flux </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="nt">output.dir </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sersic_sim</span>
</pre></div>
</div>
<p>This will load in the file <code class="docutils literal notranslate"><span class="pre">my_sim.yaml</span></code> first, then replace the whole <code class="docutils literal notranslate"><span class="pre">config['gal']</span></code> field
as well as <code class="docutils literal notranslate"><span class="pre">config['output']['dir']</span></code> (leaving the rest of <code class="docutils literal notranslate"><span class="pre">config['output']</span></code> unchanged).
The new <code class="docutils literal notranslate"><span class="pre">config['gal']</span></code> field will use the same <code class="docutils literal notranslate"><span class="pre">half_light_radius</span></code> specification from
the other file (which might be some complicated random variate that you did not want to
duplicate here).</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">template</span></code> field is not at the top level of the config dict, the adjustments should be
made relative to that level of the dictionary:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">psf </span><span class="p">:</span>
    <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cgc.yaml:psf</span>
    <span class="nt">index_key </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">obj_num</span>
    <span class="nt">items.0.ellip.e.max </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.05</span>
    <span class="nt">items.1.nstruts </span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
    <span class="nt">items.1.strut_angle </span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt"> type </span><span class="p">:</span> <span class="nv">Random</span> <span class="p p-Indicator">}</span>
</pre></div>
</div>
<p>Note that the modifications do not start with <code class="docutils literal notranslate"><span class="pre">psf.</span></code>, since the template processing is being done
within the <code class="docutils literal notranslate"><span class="pre">psf</span></code> field.</p>
<p>Finally, if you want to use a different field from the current config dict as a template, you can
use the colon notation without the file.
E.g. To have a bulge plus disk that have the same kinds of parameters, except that the overall type is a DeVaucouleurs and Exponential respectively, you could do:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">gal</span><span class="p">:</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Sum</span>
    <span class="nt">items</span><span class="p">:</span>
        <span class="p p-Indicator">-</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">DeVaucouleurs</span>
            <span class="nt">half_light_radius</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt"> type</span><span class="p">:</span> <span class="nv">Random</span><span class="p p-Indicator">,</span><span class="nt"> min</span><span class="p">:</span> <span class="nv">0.2</span><span class="p p-Indicator">,</span><span class="nt"> max</span><span class="p">:</span> <span class="nv">0.8</span> <span class="p p-Indicator">}</span>
            <span class="nt">flux</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt"> type</span><span class="p">:</span> <span class="nv">Random</span><span class="p p-Indicator">,</span><span class="nt"> min</span><span class="p">:</span> <span class="nv">100</span><span class="p p-Indicator">,</span><span class="nt"> max</span><span class="p">:</span> <span class="nv">1000</span> <span class="p p-Indicator">}</span>
            <span class="nt">ellip</span><span class="p">:</span>
                <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Eta1Eta2</span>
                <span class="nt">eta1</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt"> type</span><span class="p">:</span> <span class="nv">RandomGaussian</span><span class="p p-Indicator">,</span><span class="nt"> sigma</span><span class="p">:</span> <span class="nv">0.2</span> <span class="p p-Indicator">}</span>
                <span class="nt">eta2</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt"> type</span><span class="p">:</span> <span class="nv">RandomGaussian</span><span class="p p-Indicator">,</span><span class="nt"> sigma</span><span class="p">:</span> <span class="nv">0.2</span> <span class="p p-Indicator">}</span>
        <span class="p p-Indicator">-</span>
            <span class="nt">template</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">:gal.items.0</span>
            <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Exponential</span>
</pre></div>
</div>
<p>This would gererate different values for the size, flux, and shape of each component.  But the way those numbers are drawn would be the same for each.</p>
<p>See:</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="_downloads/2d01c182e2852ba547ea63b207cc63d1/rgc.yaml"><code class="xref download docutils literal notranslate"><span class="pre">rgc.yaml</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="_downloads/b06d696f13310734c255a97eff088d67/cgc_psf.yaml"><code class="xref download docutils literal notranslate"><span class="pre">cgc_psf.yaml</span></code></a></p></li>
</ul>
<p>for examples of this feature.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="config_galsim.html" class="btn btn-neutral float-right" title="The galsim Executable" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="config_values.html" class="btn btn-neutral float-left" title="Config Values" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, GalSim-developers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>